<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>



    <input type="date" id="calendar">
    <button onclick="showDate()">날짜 확인</button>
    <div id="resultdate"></div>

    <div id="area"></div>


    <script src="./jquery-3.7.1.min.js"></script>

    <script>
        //  영화진흥위원회 open api 이용 데이터 웹페이지 출력
        // open api 공개 소스
        // 장점 시간 비용 많이 드는 기능을 직접 구현하지않아도 된다
        // 단점 대부분 사용자한테인증키를 발급받게한다

        let btn = document.getElementById("btn");
        let area = document.getElementById("area");
        

        function showDate() {
            const selectedDate = document.getElementById('calendar').value;
            
            if (selectedDate) {
                const date = new Date(selectedDate);
                let year = date.getFullYear();
                let month = String(date.getMonth() + 1).padStart(2, '0');
                let day = String(date.getDate()).padStart(2, '0');
                document.getElementById('resultdate').innerHTML =`선택한 날짜: ${year}년 ${month}월 ${day}일`;
                let m_url = `http://kobis.or.kr/kobisopenapi/webservice/rest/boxoffice/searchDailyBoxOfficeList.json?key=06ba645b86594a7c80cc349e4a910bdd&targetDt=${year}${month}${day}`;
                getMovie();
                function getMovie() {
                    // 영화정보를 비동기 통신으로 요청
                    $.ajax({
                        url: m_url,
                        success: function (result) {
                            let movieList = result.boxOfficeResult.dailyBoxOfficeList;
                            // 영화순위 영화명 개봉일 출력
                            render(movieList);
                        },
                        error: function () {
                            console.log("요청 실패...");
                        },
                    })
                }
               
                const render = function (ml) {
                    let resultHTML = `
                    <table border = "1px soild blcak">
                        <tr>
                            <td>순위</td>
                            <td>영화명</td>
                            <td>개봉일</td>
                            <td>누적 매출액</td>
                            <td>누적 관객수</td>

                        </tr>
            `
                    for (let i = 0; i < ml.length; i++) {


                        resultHTML += `
                         <tr>
                            <td>${ml[i].rank}</td>
                            <td>${ml[i].movieNm}</td>
                            <td>${ml[i].openDt}</td>
                            <td>${new Intl.NumberFormat().format(ml[i].salesAcc)}원</td>
                            <td>${new Intl.NumberFormat().format(ml[i].audiAcc)}명</td>
                        </tr>
            `
                    }

                    resultHTML += `</table>`
                    area.innerHTML = resultHTML;

                }



            } else {
                document.getElementById('result').innerHTML =
                    '날짜를 선택해주세요';
            }
        }

           




        

    </script>



</body>

</html>